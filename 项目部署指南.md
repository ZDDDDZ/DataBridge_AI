# 管道信息智能查询系统 - 快速部署指南

## 📋 项目完成状态

✅ **数据库设计** - MySQL数据库和表结构
✅ **模拟数据生成** - 1000条可靠的管道信息数据
✅ **后端API开发** - FastAPI + LangChain + 阿里云百炼大模型
✅ **前端界面开发** - Vue3 + Ant Design Vue + AI聊天组件
✅ **数据可视化** - ECharts图表展示
✅ **项目文档** - 完整的开发和部署文档

## 🚀 快速启动步骤

### 第一步：环境准备

确保您的系统已安装：
- **Node.js** 16+ (前端)
- **Python** 3.8+ (后端)
- **MySQL** 8.0+ (数据库)
- **阿里云百炼API密钥** (AI服务)

### 第二步：数据库初始化

```bash
# 1. 连接MySQL数据库
mysql -u root -p

# 2. 执行数据库初始化
source database/init.sql

# 3. 生成模拟数据
cd database
pip install mysql-connector-python python-dotenv
python mock_data.py
```

### 第三步：后端启动

```bash
cd pipeline_backend

# 创建Python虚拟环境
python3 -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 安装依赖包
pip install -r requirements.txt

# 配置环境变量 (重要!)
# 复制并编辑配置文件
cp .env.example .env
# 修改 .env 文件中的数据库和API配置

# 启动后端服务
python3 main.py
```

后端将在 http://localhost:8000 启动

### 第四步：前端启动

```bash
cd pipeline-frontend

# 安装前端依赖
npm install

# 启动开发服务器
npm run serve
```

前端将在 http://localhost:8080 启动

## ⚙️ 配置说明

### 后端环境变量 (.env)

```env
# 数据库配置
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=你的数据库密码
DB_NAME=pipeline_management

# 阿里云百炼大模型API密钥
DASHSCOPE_API_KEY=你的API密钥

# 应用配置
API_PREFIX=/api/v1
DEBUG=True
CORS_ORIGINS=http://localhost:8080,http://127.0.0.1:8080
```

### 获取阿里云百炼API密钥

1. 访问 [阿里云百炼控制台](https://dashscope.console.aliyun.com/)
2. 注册/登录阿里云账号
3. 开通百炼服务
4. 获取API密钥并填入配置文件

## 🧪 系统测试

启动成功后，您可以测试以下功能：

1. **健康检查**：访问 http://localhost:8000/health
2. **API文档**：访问 http://localhost:8000/docs
3. **前端界面**：访问 http://localhost:8080

### 测试查询示例

在前端聊天框中输入：
- "查询广东省的燃气管道数量"
- "统计各省市管道类型分布情况"
- "2010年以后建成的供水管道有哪些？"

## 📁 项目结构总览

```
管道信息智能查询系统/
├── database/                    # 数据库相关
│   ├── init.sql                # 数据库初始化脚本
│   └── mock_data.py            # 模拟数据生成脚本
├── pipeline_backend/           # 后端项目 (FastAPI)
│   ├── app/
│   │   ├── api/               # API路由
│   │   ├── models/            # 数据模型
│   │   └── services/          # 业务服务
│   ├── config.py              # 配置管理
│   ├── main.py                # 应用入口
│   └── requirements.txt       # Python依赖
├── pipeline-frontend/          # 前端项目 (Vue3)
│   ├── src/
│   │   ├── components/        # Vue组件
│   │   ├── views/             # 页面组件
│   │   ├── services/          # API服务
│   │   └── stores/            # 状态管理
│   ├── package.json
│   └── vue.config.js
├── README.md                   # 项目说明
├── 开发设计文档.md            # 详细设计文档
└── 项目部署指南.md            # 本部署指南
```

## 🔧 常见问题排查

### 1. 后端启动失败

**问题**：导入模块失败
**解决**：确保已激活虚拟环境并安装所有依赖
```bash
source venv/bin/activate
pip install -r requirements.txt
```

**问题**：数据库连接失败
**解决**：检查 .env 文件中的数据库配置是否正确

### 2. 前端启动失败

**问题**：npm install 失败
**解决**：清除缓存重新安装
```bash
npm cache clean --force
rm -rf node_modules package-lock.json
npm install
```

### 3. AI功能不工作

**问题**：查询无响应或报错
**解决**：检查 DASHSCOPE_API_KEY 是否正确配置

## 🎯 使用说明

1. **启动系统**：按照上述步骤启动后端和前端
2. **访问系统**：打开浏览器访问 http://localhost:8080
3. **开始查询**：在聊天框中输入自然语言问题
4. **查看结果**：系统会自动生成SQL并展示结果
5. **数据分析**：切换到图表视图进行数据可视化分析

## 📊 系统特性

- ✨ **智能对话**：基于大语言模型的自然语言理解
- 🔍 **SQL生成**：自动将中文问题转换为精确SQL查询
- 📈 **数据可视化**：多种图表类型展示查询结果
- 💾 **历史记录**：自动保存查询历史，支持快速重复查询
- 📱 **响应式设计**：适配桌面和移动设备
- 🔒 **安全设计**：SQL注入防护和查询权限控制

## 📞 技术支持

如果在部署过程中遇到问题，请检查：

1. **环境要求**是否满足
2. **配置文件**是否正确设置
3. **网络连接**是否正常
4. **API密钥**是否有效

---

**恭喜！** 您已成功部署管道信息智能查询系统。现在可以开始使用自然语言查询管道数据了！🎉 